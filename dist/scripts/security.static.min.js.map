{"version":3,"names":["SecurityStatic","constructor","this","cryptoAvailable","Boolean","window","crypto","subtle","rateLimiter","Map","sessionData","isInitialized","testMode","TEST_MODE","config","rateLimit","answerSubmission","maxAttempts","timeWindow","puzzleAccess","qrScan","hashing","algorithm","iterations","saltLength","session","maxAge","renewThreshold","init","initializeSession","startCleanupInterval","console","log","id","generateSecureId","createdAt","Date","now","lastActivity","set","sessionStorage","setItem","validateSession","s","get","age","idle","invalidateSession","renewSession","Promise","r","setTimeout","newId","newSession","delete","removeItem","createSecureHash","input","salt","generateSalt","createFallbackHash","enc","TextEncoder","key","importKey","encode","bits","deriveBits","name","hash","Array","from","Uint8Array","map","b","toString","padStart","join","i","length","charCodeAt","verifyHash","hashedValue","split","hmacSHA256","msg","format","fallbackHmac","k","sig","sign","bytes","bin","forEach","String","fromCharCode","b64","btoa","simpleHash","hashAnswer","answer","normalized","toLowerCase","trim","checkRateLimit","action","cfg","winStart","attempts","filter","t","push","len","a","getRandomValues","Math","random","substring","str","h","abs","arr","floor","setInterval","entries","recent","getSecurityReport","initialized","sessionValid","rateLimitEntries","size","version","features","deterministicHashing","base64Padding","asyncSessionValidation","pbkdf2Consistency","enhancedHMAC","rateLimiting","module","exports"],"sources":["scripts/security.static.js"],"mappings":"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","ignoreList":[]}