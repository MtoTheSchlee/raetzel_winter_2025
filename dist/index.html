<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SecurityStatic v2.2 ‚Äì Production Demo</title>
    <style>
        /* Generated by Copilot Jason v2.3 */
        body {
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, sans-serif;
            line-height: 1.6;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #2c3e50;
            min-height: 100vh;
        }
        
        .container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.1);
        }
        
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }
        
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .feature-card {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            border-left: 4px solid #3498db;
        }
        
        .status-panel {
            background: #e8f5e8;
            border: 1px solid #d4edda;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
        }
        
        .test-button {
            background: linear-gradient(45deg, #3498db, #2ecc71);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            margin: 5px;
            transition: all 0.3s ease;
        }
        
        .test-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .result {
            background: #f1f3f4;
            border-radius: 5px;
            padding: 10px;
            margin: 10px 0;
            font-family: 'SF Mono', Monaco, monospace;
            font-size: 14px;
            white-space: pre-wrap;
        }
        
        .version-badge {
            display: inline-block;
            background: #2ecc71;
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîí SecurityStatic v2.2 <span class="version-badge">Production Ready</span></h1>
        
        <div class="status-panel">
            <h3>üìä System Status</h3>
            <div id="systemStatus">Initialisiere SecurityStatic...</div>
        </div>
        
        <div class="feature-grid">
            <div class="feature-card">
                <h3>üîê Hashing & Encryption</h3>
                <p>PBKDF2 with deterministic salts, HMAC-SHA256, and multiple output formats</p>
                <button class="test-button" onclick="testHashing()">Test Hashing</button>
                <div id="hashResult" class="result"></div>
            </div>
            
            <div class="feature-card">
                <h3>üïí Session Management</h3>
                <p>Automatic session validation, renewal, and secure ID generation</p>
                <button class="test-button" onclick="testSession()">Test Session</button>
                <div id="sessionResult" class="result"></div>
            </div>
            
            <div class="feature-card">
                <h3>‚ö° Rate Limiting</h3>
                <p>Configurable time windows with per-action and per-identifier tracking</p>
                <button class="test-button" onclick="testRateLimit()">Test Rate Limit</button>
                <div id="rateLimitResult" class="result"></div>
            </div>
            
            <div class="feature-card">
                <h3>üéØ Integration Test</h3>
                <p>Complete puzzle answer flow with normalization and validation</p>
                <button class="test-button" onclick="testIntegration()">Full Integration Test</button>
                <div id="integrationResult" class="result"></div>
            </div>
        </div>
        
        <div class="status-panel">
            <h3>üîç Security Report</h3>
            <div id="securityReport" class="result"></div>
        </div>
        
        <div style="text-align: center; margin-top: 30px; color: #7f8c8d;">
            <small>Generated by Copilot Jason v2.3 | SecurityStatic v2.2 with SRI integrity</small>
        </div>
    </div>

    <!-- SecurityStatic v2.2 ‚Äì Production Build with SRI -->
    <script src="scripts/security.static.min.js" 
            integrity="sha384-AzZ+erTmvih54cJjCqCcBXdJtbYApX6ZuM8l99+JGFJCMpOwehwobgV10RsusJ4k" 
            crossorigin="anonymous"></script>
    
    <script>
        // Generated by Copilot Jason v2.3
        let securityInstance;
        
        async function initializeSecurityStatic() {
            try {
                securityInstance = window.SecurityStatic;
                await securityInstance.init();
                
                document.getElementById('systemStatus').innerHTML = `
                    ‚úÖ SecurityStatic v2.2 erfolgreich geladen
                    üåê Browser Crypto API: ${securityInstance.cryptoAvailable ? '‚úÖ Verf√ºgbar' : '‚ùå Fallback'}
                    üîÑ Initialisiert: ${securityInstance.isInitialized ? '‚úÖ Ja' : '‚ùå Nein'}
                `;
                
                updateSecurityReport();
            } catch (error) {
                document.getElementById('systemStatus').innerHTML = `‚ùå Fehler: ${error.message}`;
            }
        }
        
        async function testHashing() {
            const result = document.getElementById('hashResult');
            try {
                const testInput = 'TestAnswer2025';
                
                // Test verschiedene Hash-Formate
                const hexHash = await securityInstance.hashInput(testInput, { 
                    deterministicSalt: true, 
                    outputFormat: 'hex' 
                });
                
                const base64Hash = await securityInstance.hashInput(testInput, { 
                    deterministicSalt: true, 
                    outputFormat: 'base64' 
                });
                
                const hmacResult = await securityInstance.hmacSha256('testKey', testInput, {
                    outputFormat: 'hex'
                });
                
                result.innerHTML = `
‚úÖ PBKDF2 Hash (Hex): ${hexHash.substring(0, 32)}...
‚úÖ PBKDF2 Hash (Base64): ${base64Hash.substring(0, 32)}...
‚úÖ HMAC-SHA256: ${hmacResult.substring(0, 32)}...

üîç Deterministic: ${hexHash === await securityInstance.hashInput(testInput, { deterministicSalt: true, outputFormat: 'hex' }) ? 'Ja' : 'Nein'}
                `;
            } catch (error) {
                result.innerHTML = `‚ùå Hash-Test Fehler: ${error.message}`;
            }
        }
        
        async function testSession() {
            const result = document.getElementById('sessionResult');
            try {
                // Session-Validierung testen
                const isValid = await securityInstance.validateSession();
                const sessionData = securityInstance.sessionData.get('current');
                
                result.innerHTML = `
‚úÖ Session Valid: ${isValid ? 'Ja' : 'Nein'}
üÜî Session ID: ${sessionData?.id?.substring(0, 16)}...
‚è∞ Created: ${new Date(sessionData?.createdAt).toLocaleString('de-DE')}
üîÑ Last Activity: ${new Date(sessionData?.lastActivity).toLocaleString('de-DE')}
                `;
            } catch (error) {
                result.innerHTML = `‚ùå Session-Test Fehler: ${error.message}`;
            }
        }
        
        function testRateLimit() {
            const result = document.getElementById('rateLimitResult');
            try {
                // Rate-Limiting f√ºr verschiedene Actions testen
                const tests = [];
                
                for (let i = 0; i < 5; i++) {
                    const allowed = securityInstance.checkRateLimit('answerSubmission', 'testUser');
                    tests.push(`Versuch ${i + 1}: ${allowed ? '‚úÖ Erlaubt' : '‚ùå Blockiert'}`);
                }
                
                const rateLimitInfo = securityInstance.getRateLimitInfo('answerSubmission', 'testUser');
                
                result.innerHTML = `
${tests.join('\n')}

üìä Rate Limit Info:
   Verbleibend: ${rateLimitInfo.remaining}
   Max Versuche: ${rateLimitInfo.config.maxAttempts}
   Zeitfenster: ${rateLimitInfo.config.timeWindow / 1000}s
                `;
            } catch (error) {
                result.innerHTML = `‚ùå Rate-Limit-Test Fehler: ${error.message}`;
            }
        }
        
        async function testIntegration() {
            const result = document.getElementById('integrationResult');
            try {
                const testAnswer = 'Winter-R√§tsel 2025!';
                
                // Kompletter Answer-Flow
                const hashedAnswer = await securityInstance.hashAnswer(testAnswer, {
                    algorithm: 'PBKDF2',
                    outputFormat: 'hex',
                    deterministicSalt: true
                });
                
                // Rate-Limit pr√ºfen
                const rateLimitOk = securityInstance.checkRateLimit('answerSubmission', 'integrationTest');
                
                // Session validieren
                const sessionValid = await securityInstance.validateSession();
                
                result.innerHTML = `
üéØ Integration Test erfolgreich!

üìù Original: "${testAnswer}"
üîê Normalisiert: "winter-r√§tsel 2025"  
üîë Hash: ${hashedAnswer.substring(0, 32)}...
‚ö° Rate Limit: ${rateLimitOk ? '‚úÖ OK' : '‚ùå Blockiert'}
üîí Session: ${sessionValid ? '‚úÖ G√ºltig' : '‚ùå Ung√ºltig'}

‚úÖ Puzzle-Answer-Flow vollst√§ndig getestet
                `;
            } catch (error) {
                result.innerHTML = `‚ùå Integration-Test Fehler: ${error.message}`;
            }
        }
        
        function updateSecurityReport() {
            try {
                const report = securityInstance.getSecurityReport();
                document.getElementById('securityReport').innerHTML = JSON.stringify(report, null, 2);
            } catch (error) {
                document.getElementById('securityReport').innerHTML = `Fehler beim Laden: ${error.message}`;
            }
        }
        
        // Auto-Initialize bei Seitenladung
        window.addEventListener('load', initializeSecurityStatic);
        
        // Update Security Report alle 10 Sekunden
        setInterval(updateSecurityReport, 10000);
    </script>
</body>
</html>